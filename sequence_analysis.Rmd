- [Back to index](index.html)

# Sequence analysis of mothers monthly activities birth


```{roptssequence, echo=FALSE}
opts_chunk$set(echo=FALSE,eval=TRUE,fig.height=8, fig.width=10,cache=TRUE)
```

```{rsequencelloaddata}
load("data/datEnterBirth4.RData")
```

```{rsequenceMunge}
library(reshape2)
varlist <- c("PER_ID","RB010","RB020","PL210A","PL210B",
             "PL210C","PL210D",
             "PL210E","PL210F",
             "PL210G","PL210H",
             "PL210I","PL210J",
             "PL210K","PL210L")

dat2005 <- datEnterBirth4[datEnterBirth4$RB010 == 2005,varlist]
dat2005.l <- melt(dat2005, id.vars = c("RB010","RB020","PER_ID"))
# 1 2006
dat2006 <- datEnterBirth4[datEnterBirth4$RB010 == 2006,varlist]
dat2006.l <- melt(dat2006, id.vars = c("RB010","RB020","PER_ID"))
# 1 2007
dat2007 <- datEnterBirth4[datEnterBirth4$RB010 == 2007,varlist]
dat2007.l <- melt(dat2007, id.vars = c("RB010","RB020","PER_ID"))
# 1 2008
dat2008 <- datEnterBirth4[datEnterBirth4$RB010 == 2008,varlist]
dat2008.l <- melt(dat2008, id.vars = c("RB010","RB020","PER_ID"))
# 1 2009
dat2009 <- datEnterBirth4[datEnterBirth4$RB010 == 2009,varlist]
dat2009.l <- melt(dat2009, id.vars = c("RB010","RB020","PER_ID"))
# 2010
dat2010 <- datEnterBirth4[datEnterBirth4$RB010 == 2010,varlist]
dat2010.l <- melt(dat2010, id.vars = c("RB010","RB020","PER_ID"))
# 2011
dat2011 <- datEnterBirth4[datEnterBirth4$RB010 == 2011,varlist]
dat2011.l <- melt(dat2011, id.vars = c("RB010","RB020","PER_ID"))

dat <- rbind(#dat2005.l,
             dat2006.l,
             dat2007.l,
             dat2008.l,
             dat2009.l,
             dat2010.l,
             dat2011.l)

dat$time[dat$variable == "PL210A"] <- "01-01"
dat$time[dat$variable == "PL210B"] <- "02-01"
dat$time[dat$variable == "PL210C"] <- "03-01"
dat$time[dat$variable == "PL210D"] <- "04-01"
dat$time[dat$variable == "PL210E"] <- "05-01"
dat$time[dat$variable == "PL210F"] <- "06-01"
dat$time[dat$variable == "PL210G"] <- "07-01"
dat$time[dat$variable == "PL210H"] <- "08-01"
dat$time[dat$variable == "PL210I"] <- "09-01"
dat$time[dat$variable == "PL210J"] <- "10-01"
dat$time[dat$variable == "PL210K"] <- "11-01"
dat$time[dat$variable == "PL210L"] <- "12-01"
dat$date <- paste(dat$RB010,dat$time,sep="-")
dat$date <- as.Date(dat$date)

dat$value[is.na(dat$value)] <- 0
```


```{rsequenceRank}
library(data.table)
dat <- data.table(dat,key = "PER_ID")
dat <- dat[,transform(.SD,Order = rank(date,
                                ties.method = "first")),by = PER_ID]

dat$XOrder <- paste("X",dat$Order,sep="")
datW <- dcast(dat, PER_ID + RB010 + RB020 ~ XOrder,
             value.vars="value")
             
             


```


```{rsequencePlot}

library(TraMineR)

seqstatl(datW[, 4:75])

datW.labels <- c("Employee (full-time)",
                 "Employee (part-time)",
                 "Self-employed (full-time)",
                 "Self-employed (part-time)",
                 "unemployed",
                 "Retired",
                 "Student",
                 "Other inactive")

datW.scodes <- c("EmpF",
                 "EmpPT",
                 "SEmpF",
                 "SEmpPT",
                 "ue",
                 "ret",
                 "stu",
                 "OtInac")

mvad.seq <- seqdef(datW, 4:75, states = datW.scodes, 
    labels = datW.labels, xtstep = 8)

par(mfrow = c(2, 2))
seqiplot(mvad.seq, withlegend = FALSE, border = NA)
seqIplot(mvad.seq, sortv = "from.start", withlegend = TRUE)
#seqlegend(mvad.seq)


```
